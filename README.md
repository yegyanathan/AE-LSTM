# Deep Learning-Based Stock Price Prediction using Composite AE-LSTM Model

This study focuses on using Deep Learning for predicting the day ahead closing price based on past stock data. The problem is formulated as a multivariate timeseries forecast. For this, the 10 most influential industries in the Tehran Stock Exchange (TSE) were chosen. Seven-year historical data consisting of the Opening value, Highest value, Lowest value, and trading volume (OHLCV) of these stocks were used for training the model. The Deep Learning architecture integrates an Autoencoder (AE) based on LSTM for feature selection and stacked LSTM for predicting the closing price of the stock.


# Autoencoder

Autoencoder (AE) consists the encoder and the decoder components. The encoder tries to distill the input into a concise representation whereas the decoder tries to reproduce the original input from the concise version. In the process, the model learns to compress the data without losing the relevant information in it. AE usually consists of encoder and decoder that are based on Multi-Layer Perceptrons (MLP). The autoencoder used in this architecture is based on LSTM cell. The design decision was made keeping in mind the temporal nature of the data. The AE takes in 5-dimensional OHLCV data and is trained to compress it into a 2-dimensional representation.



## LSTM

Recurrent Neural Networks (RNN) are a type of Artificial Neural Network that can model sequential/temporal data. As the name suggests, RNNs can capture recurrent relations in a sequence of data with the help of its hidden state which acts like a memory. The hidden state accumulates temporal information and is shared between each timestep. But the RNN suffers from the vanishing gradient problem, which limits it from learning long time dependencies. A variant of the RNN called the LSTM solves this problem by introducing gates that can retain information that is important and discard irrelevant information. It also incorporates a cell state that acts as a highway for efficient gradient flow during Back Propagation Through Time (BPTT). The LSTM Implements 4 gates â€“ Input, Output, Forget, (Input Modulation) Memory Gate. Fig, shows the internal configuration of an LSTM cell.

**![](https://lh5.googleusercontent.com/g8Htzr2wyY5Rbsi1mvkMOQ93JH17BsbeAM7vlGO6hsI5kkNX5BqYbTQ_o6O56nErAFsSbd6KbhaStA9XueFYmpEGoCR98YVrHocDlPyIAdmv4U_l3o7CWVzNUt-B1ojioH8MDX8jD2Zze-STJhI0mIU)**

![enter image description here](data:image/png;base64,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)
## Model Training
The training phase of the AE-LSTM model is composite in nature. Two separate losses are computed simultaneously at each step, in two separate branches of the model. The Encoder-Decoder branch compresses and decompresses the input data, whereas the Encoder-LSTM branch predicts the closing price of the stock using the compressed representation. The reconstruction loss and the loss due to prediction are backpropagated in their respective branches. The data was split into 80% training set - 10% validation set - 10% testing set. Mean Absolute Error (MAE) was used for calculating the loss. ADAM optimizer was used for minimizing the loss function. Early stopping and weight decaying are some methods that were used to prevent the overfitting of the model.

## Model Validation and Testing:
The validation set was used to monitor the performance of the model. Training loss and validation loss were computed for every epoch to observe the extent to which the model generalized to new data. The effectiveness of the AE-LSTM model was verified by comparing it with a baseline LSTM model. The baseline LSTM model took 16 epochs to converge whereas the AE-LSTM model took 200 epochs to complete training. Hyperparameters were randomly chosen based on intuition.
